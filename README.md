# 鼠标精灵 (Mouse Spirit)

一个功能强大的鼠标和键盘动作录制回放工具，支持路径优化和高速执行。

## 主要功能

### 录制功能
- 鼠标移动轨迹记录
- 鼠标点击事件捕获（左键和右键）
- 键盘输入记录（支持组合键）
- 智能路径优化，减少冗余移动点
- 支持录制暂停/继续

### 回放功能
- 支持多次循环执行
- 可调节执行速度（1%-200%）
- 智能检测用户干预自动停止
- 支持路径优化执行
- 键盘动作精确回放（包括组合键）
- 优化的加速算法，使高速执行更明显

### 编辑功能
- 可视化动作列表
- 支持删除单个动作
- 支持编辑动作参数
- 一键优化路径
- 一键压缩时间间隔
- 区分不同类型动作的时间间隔设置

### 其他特性
- 全局热键支持（默认F6录制，F10执行）
- 可自定义热键设置
- 动作配置保存和加载
- 友好的图形界面
- 实时状态显示
- 优化的退出逻辑，防止误触发
- 更好的错误处理和恢复机制

## 使用说明

### 基本操作
1. 开始录制：点击"开始录制"按钮或按F6
2. 停止录制：再次点击按钮或按F6
3. 开始执行：点击"启动"按钮或按F10
4. 停止执行：再次点击按钮或按F10

### 优化设置
- **鼠标精度**：调节记录移动点的精度（1-1000）
- **执行速度**：调节回放速度（1%-200%）
- **优化路径**：勾选此项可减少记录的移动点
- **记录键盘**：勾选此项可记录键盘输入

### 组合键使用
现在支持更好的组合键录制和回放：
- 可以同时按下多个键（如Ctrl+Alt+Del）
- 支持常见的组合键如Ctrl+C、Ctrl+V等
- 特别优化了Ctrl+Space等包含空格键的组合
- 录制时会显示组合键信息

### 高级功能
1. **路径优化**：
   - 点击"优化路径"按钮删除冗余的移动点
   - 只保留必要的路径点，提高执行效率

2. **时间压缩**：
   - 点击"压缩时间"按钮最小化动作间隔
   - 不同类型的动作使用不同的时间间隔
   - 鼠标移动：1毫秒
   - 鼠标点击：10毫秒
   - 键盘按键：5毫秒
   - 连续键盘输入：1毫秒

3. **动作编辑**：
   - 双击动作列表中的项目可编辑详细参数
   - 选中动作后按Delete键可删除
   - 右键菜单提供快捷操作

## 注意事项

1. **安全提示**：
   - 首次运行时可能需要管理员权限
   - 执行过程中如需停止，移动鼠标即可
   - 建议在执行前保存重要工作
   - 退出时有确认提示，防止误操作

2. **性能优化**：
   - 录制时建议勾选"优化路径"选项
   - 对于复杂操作，建议先录制后优化
   - 可以使用压缩时间功能提高执行速度
   - 提高执行速度时，加速效果更加明显

3. **兼容性**：
   - 支持Windows系统
   - 需要Python 3.6或更高版本
   - 依赖pynput库（如果不可用会自动切换到备用模式）

## 快捷键

- F6：开始/停止录制
- F10：开始/停止执行
- Delete：删除选中的动作
- 双击：编辑选中的动作

## 依赖安装

```bash
pip install pynput
pip install pyautogui
pip install tkinter
```

## 常见问题

1. **录制没有反应**
   - 检查是否有管理员权限
   - 确认pynput库是否正确安装
   - 查看是否被安全软件拦截

2. **执行不准确**
   - 调整鼠标精度参数
   - 使用路径优化功能
   - 降低执行速度

3. **热键无效**
   - 检查是否有其他程序占用热键
   - 在热键设置中重新配置
   - 确认是否以管理员身份运行

4. **组合键不工作**
   - 确保修饰键（Ctrl、Alt等）按下时间足够长
   - 检查组合键是否有冲突
   - 对于包含空格键的组合，确保使用最新版本

## 更新日志

### v1.2.0
- 优化退出逻辑，防止误操作
- 改进加速效果，高速模式更加明显
- 添加对组合键的全面支持
- 优化空格键处理，解决组合键问题
- 增强错误处理和恢复机制
- 改进时间压缩算法，针对不同动作类型

### v1.1.0
- 添加路径优化功能
- 添加时间压缩功能
- 优化键盘输入处理
- 改进执行效率
- 界面美化

### v1.0.0
- 基础的录制和回放功能
- 鼠标和键盘事件支持
- 图形界面实现 